inherited dmData: TdmData
  OldCreateOrder = True
  inherited dbOptimiza: TIBDatabase
    Left = 320
  end
  inherited prcFireEvent: TIBStoredProc
    Left = 384
  end
  inherited trnOptimiza: TIBTransaction
    Left = 320
  end
  object srcSrcProd: TDataSource
    DataSet = qrySrcProd
    Left = 24
    Top = 8
  end
  object qrySrcProd: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select ProductCode, ProductDescription from Product'
      '  where 1=1'
      'Order by ProductCode')
    Left = 96
    Top = 8
  end
  object qrySrcLocation: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select * from Location'
      'Order by Description')
    Left = 104
    Top = 72
  end
  object srcSrcLocation: TDataSource
    DataSet = qrySrcLocation
    Left = 24
    Top = 72
  end
  object qryTgtProd: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select ProductCode, ProductDescription from Product'
      '  where 1=1'
      'Order by ProductCode')
    Left = 168
    Top = 8
  end
  object qryTgtLocation: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select * from Location'
      'Order by Description')
    Left = 240
    Top = 8
  end
  object srcTgtProd: TDataSource
    DataSet = qryTgtProd
    Left = 168
    Top = 72
  end
  object srcTgtLocation: TDataSource
    DataSet = qryTgtLocation
    Left = 240
    Top = 72
  end
  object qryPeriod: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select Description from Calendar'
      '  where Calendarno >= :StartPeriod'
      '  and CalendarNo <= :EndPeriod')
    Left = 24
    Top = 144
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'StartPeriod'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'EndPeriod'
        ParamType = ptUnknown
      end>
  end
  object srcPeriod: TDataSource
    DataSet = qryPeriod
    Left = 120
    Top = 144
  end
  object qryCheckProc: TIBSQL
    Database = dbOptimiza
    ParamCheck = False
    SQL.Strings = (
      'Select * from rdb$procedures where'
      'RDB$PROCEDURE_NAME = "UP_COPYSALES"')
    Transaction = trnOptimiza
    Left = 32
    Top = 224
  end
  object qryAddStoredProc: TIBSQL
    Database = dbOptimiza
    ParamCheck = False
    SQL.Strings = (
      
        'create procedure up_copysales (SOURCELOCATIONCODE varchar(10), T' +
        'ARGETLOCATIONCODE varchar(10),'
      
        ' SOURCEPRODUCTCODE varchar(30), TARGETPRODUCTCODE varchar(30),Re' +
        'placeInd Char(1))'
      'as'
      'declare variable xSourceLocationNo integer;'
      '  declare variable xTargetLocationNo integer;'
      '  declare variable xSourceItemNo integer;'
      '  declare variable xTargetItemNo integer;'
      '  declare variable xSourceAge integer;'
      '  declare variable xTargetAge integer;'
      '  declare variable xSALESAMOUNT_0         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_1         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_2         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_3         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_4         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_5         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_6         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_7         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_8         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_9         DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_10        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_11        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_12        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_13        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_14        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_15        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_16        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_17        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_18        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_19        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_20        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_21        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_22        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_23        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_24        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_25        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_26        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_27        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_28        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_29        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_30        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_31        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_32        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_33        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_34        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_35        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_36        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_37        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_38        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_39        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_40        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_41        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_42        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_43        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_44        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_45        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_46        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_47        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_48        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_49        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_50        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_51        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_52        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_53        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_54        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_55        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_56        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_57        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_58        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_59        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_60        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_61        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_62        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_63        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_64        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_65        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_66        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_67        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_68        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_69        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_70        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_71        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_72        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_73        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_74        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_75        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_76        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_77        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_78        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_79        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_80        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_81        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_82        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_83        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_84        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_85        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_86        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_87        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_88        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_89        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_90        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_91        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_92        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_93        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_94        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_95        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_96        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_97        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_98        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_99        DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_100       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_101       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_102       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_103       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_104       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_105       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_106       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_107       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_108       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_109       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_110       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_111       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_112       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_113       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_114       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_115       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_116       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_117       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_118       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_119       DOUBLE PRECISION;'
      '  declare variable xSALESAMOUNT_120       DOUBLE PRECISION;'
      'begin'
      ' Select LocationNO From Location where LocationCode ='
      '      :TARGETLOCATIONCODE'
      '      into :xTargetLocationNo;'
      '  Select LocationNO From Location where LocationCode ='
      '      :SOURCELOCATIONCODE'
      '      into :xSourceLocationNo;'
      
        'Select ItemNo, Age From Item where locationno = :xSourceLocation' +
        'No'
      
        '           and productno = (Select ProductNO From Product where ' +
        'ProductCode ='
      '      :SOURCEPRODUCTCODE)'
      '      into :xSourceItemNo, :xSourceAge;'
      
        'Select ItemNo, Age From Item where locationno = :xTargetLocation' +
        'No'
      
        '           and productno = (Select ProductNO From Product where ' +
        'ProductCode ='
      '      :TARGETPRODUCTCODE)'
      '      into :xTargetItemNo, :xTargetAge;'
      'IF (xSourceAge > xTargetAge) Then'
      'begin'
      '  xTargetAge = xSourceAge;'
      'end'
      ''
      'For Select s.SALESAMOUNT_0'
      '        , s.SALESAMOUNT_1'
      '        , s.SALESAMOUNT_2'
      '        , s.SALESAMOUNT_3'
      '        , s.SALESAMOUNT_4'
      '        , s.SALESAMOUNT_5'
      '        , s.SALESAMOUNT_6'
      '        , s.SALESAMOUNT_7'
      '        , s.SALESAMOUNT_8'
      '        , s.SALESAMOUNT_9'
      '        , s.SALESAMOUNT_10'
      '        , s.SALESAMOUNT_11'
      '        , s.SALESAMOUNT_12'
      '        , s.SALESAMOUNT_13'
      '        , s.SALESAMOUNT_14'
      '        , s.SALESAMOUNT_15'
      '        , s.SALESAMOUNT_16'
      '        , s.SALESAMOUNT_17'
      '        , s.SALESAMOUNT_18'
      '        , s.SALESAMOUNT_19'
      '        , s.SALESAMOUNT_20'
      '        , s.SALESAMOUNT_21'
      '        , s.SALESAMOUNT_22'
      '        , s.SALESAMOUNT_23'
      '        , s.SALESAMOUNT_24'
      '        , s.SALESAMOUNT_25'
      '        , s.SALESAMOUNT_26'
      '        , s.SALESAMOUNT_27'
      '        , s.SALESAMOUNT_28'
      '        , s.SALESAMOUNT_29'
      '        , s.SALESAMOUNT_30'
      '        , s.SALESAMOUNT_31'
      '        , s.SALESAMOUNT_32'
      '        , s.SALESAMOUNT_33'
      '        , s.SALESAMOUNT_34'
      '        , s.SALESAMOUNT_35'
      '        , s.SALESAMOUNT_36'
      '        , s.SALESAMOUNT_37'
      '        , s.SALESAMOUNT_38'
      '        , s.SALESAMOUNT_39'
      '        , s.SALESAMOUNT_40'
      '        , s.SALESAMOUNT_41'
      '        , s.SALESAMOUNT_42'
      '        , s.SALESAMOUNT_43'
      '        , s.SALESAMOUNT_44'
      '        , s.SALESAMOUNT_45'
      '        , s.SALESAMOUNT_46'
      '        , s.SALESAMOUNT_47'
      '        , s.SALESAMOUNT_48'
      '        , s.SALESAMOUNT_49'
      '        , s.SALESAMOUNT_50'
      '        , s.SALESAMOUNT_51'
      '        , s.SALESAMOUNT_52'
      '        , s.SALESAMOUNT_53'
      '        , s.SALESAMOUNT_54'
      '        , s.SALESAMOUNT_55'
      '        , s.SALESAMOUNT_56'
      '        , s.SALESAMOUNT_57'
      '        , s.SALESAMOUNT_58'
      '        , s.SALESAMOUNT_59'
      '        , s.SALESAMOUNT_60'
      '        , s.SALESAMOUNT_61'
      '        , s.SALESAMOUNT_62'
      '        , s.SALESAMOUNT_63'
      '        , s.SALESAMOUNT_64'
      '        , s.SALESAMOUNT_65'
      '        , s.SALESAMOUNT_66'
      '        , s.SALESAMOUNT_67'
      '        , s.SALESAMOUNT_68'
      '        , s.SALESAMOUNT_69'
      '        , s.SALESAMOUNT_70'
      '        , s.SALESAMOUNT_71'
      '        , s.SALESAMOUNT_72'
      '        , s.SALESAMOUNT_73'
      '        , s.SALESAMOUNT_74'
      '        , s.SALESAMOUNT_75'
      '        , s.SALESAMOUNT_76'
      '        , s.SALESAMOUNT_77'
      '        , s.SALESAMOUNT_78'
      '        , s.SALESAMOUNT_80'
      '        , s.SALESAMOUNT_81'
      '        , s.SALESAMOUNT_82'
      '        , s.SALESAMOUNT_83'
      '        , s.SALESAMOUNT_84'
      '        , s.SALESAMOUNT_85'
      '        , s.SALESAMOUNT_86'
      '        , s.SALESAMOUNT_87'
      '        , s.SALESAMOUNT_88'
      '        , s.SALESAMOUNT_89'
      '        , s.SALESAMOUNT_90'
      '        , s.SALESAMOUNT_91'
      '        , s.SALESAMOUNT_92'
      '        , s.SALESAMOUNT_93'
      '        , s.SALESAMOUNT_94'
      '        , s.SALESAMOUNT_95'
      '        , s.SALESAMOUNT_96'
      '        , s.SALESAMOUNT_97'
      '        , s.SALESAMOUNT_98'
      '        , s.SALESAMOUNT_99'
      '        , s.SALESAMOUNT_100'
      '        , s.SALESAMOUNT_101'
      '        , s.SALESAMOUNT_102'
      '        , s.SALESAMOUNT_103'
      '        , s.SALESAMOUNT_104'
      '        , s.SALESAMOUNT_105'
      '        , s.SALESAMOUNT_106'
      '        , s.SALESAMOUNT_107'
      '        , s.SALESAMOUNT_108'
      '        , s.SALESAMOUNT_109'
      '        , s.SALESAMOUNT_110'
      '        , s.SALESAMOUNT_111'
      '        , s.SALESAMOUNT_112'
      '        , s.SALESAMOUNT_113'
      '        , s.SALESAMOUNT_114'
      '        , s.SALESAMOUNT_115'
      '        , s.SALESAMOUNT_116'
      '        , s.SALESAMOUNT_117'
      '        , s.SALESAMOUNT_118'
      '        , s.SALESAMOUNT_119'
      '        , s.SALESAMOUNT_120'
      '       From ItemSales s'
      '            where s.ItemNo = :xSourceItemNo'
      '        Into'
      '          :xSALESAMOUNT_0'
      '        , :xSALESAMOUNT_1'
      '        , :xSALESAMOUNT_2'
      '        , :xSALESAMOUNT_3'
      '        , :xSALESAMOUNT_4'
      '        , :xSALESAMOUNT_5'
      '        , :xSALESAMOUNT_6'
      '        , :xSALESAMOUNT_7'
      '        , :xSALESAMOUNT_8'
      '        , :xSALESAMOUNT_9'
      '        , :xSALESAMOUNT_10'
      '        , :xSALESAMOUNT_11'
      '        , :xSALESAMOUNT_12'
      '        , :xSALESAMOUNT_13'
      '        , :xSALESAMOUNT_14'
      '        , :xSALESAMOUNT_15'
      '        , :xSALESAMOUNT_16'
      '        , :xSALESAMOUNT_17'
      '        , :xSALESAMOUNT_18'
      '        , :xSALESAMOUNT_19'
      '        , :xSALESAMOUNT_20'
      '        , :xSALESAMOUNT_21'
      '        , :xSALESAMOUNT_22'
      '        , :xSALESAMOUNT_23'
      '        , :xSALESAMOUNT_24'
      '        , :xSALESAMOUNT_25'
      '        , :xSALESAMOUNT_26'
      '        , :xSALESAMOUNT_27'
      '        , :xSALESAMOUNT_28'
      '        , :xSALESAMOUNT_29'
      '        , :xSALESAMOUNT_30'
      '        , :xSALESAMOUNT_31'
      '        , :xSALESAMOUNT_32'
      '        , :xSALESAMOUNT_33'
      '        , :xSALESAMOUNT_34'
      '        , :xSALESAMOUNT_35'
      '        , :xSALESAMOUNT_36'
      '        , :xSALESAMOUNT_37'
      '        , :xSALESAMOUNT_38'
      '        , :xSALESAMOUNT_39'
      '        , :xSALESAMOUNT_40'
      '        , :xSALESAMOUNT_41'
      '        , :xSALESAMOUNT_42'
      '        , :xSALESAMOUNT_43'
      '        , :xSALESAMOUNT_44'
      '        , :xSALESAMOUNT_45'
      '        , :xSALESAMOUNT_46'
      '        , :xSALESAMOUNT_47'
      '        , :xSALESAMOUNT_48'
      '        , :xSALESAMOUNT_49'
      '        , :xSALESAMOUNT_50'
      '        , :xSALESAMOUNT_51'
      '        , :xSALESAMOUNT_52'
      '        , :xSALESAMOUNT_53'
      '        , :xSALESAMOUNT_54'
      '        , :xSALESAMOUNT_55'
      '        , :xSALESAMOUNT_56'
      '        , :xSALESAMOUNT_57'
      '        , :xSALESAMOUNT_58'
      '        , :xSALESAMOUNT_59'
      '        , :xSALESAMOUNT_60'
      '        , :xSALESAMOUNT_61'
      '        , :xSALESAMOUNT_62'
      '        , :xSALESAMOUNT_63'
      '        , :xSALESAMOUNT_64'
      '        , :xSALESAMOUNT_65'
      '        , :xSALESAMOUNT_66'
      '        , :xSALESAMOUNT_67'
      '        , :xSALESAMOUNT_68'
      '        , :xSALESAMOUNT_69'
      '        , :xSALESAMOUNT_70'
      '        , :xSALESAMOUNT_71'
      '        , :xSALESAMOUNT_72'
      '        , :xSALESAMOUNT_73'
      '        , :xSALESAMOUNT_74'
      '        , :xSALESAMOUNT_75'
      '        , :xSALESAMOUNT_76'
      '        , :xSALESAMOUNT_77'
      '        , :xSALESAMOUNT_78'
      '        , :xSALESAMOUNT_80'
      '        , :xSALESAMOUNT_81'
      '        , :xSALESAMOUNT_82'
      '        , :xSALESAMOUNT_83'
      '        , :xSALESAMOUNT_84'
      '        , :xSALESAMOUNT_85'
      '        , :xSALESAMOUNT_86'
      '        , :xSALESAMOUNT_87'
      '        , :xSALESAMOUNT_88'
      '        , :xSALESAMOUNT_89'
      '        , :xSALESAMOUNT_90'
      '        , :xSALESAMOUNT_91'
      '        , :xSALESAMOUNT_92'
      '        , :xSALESAMOUNT_93'
      '        , :xSALESAMOUNT_94'
      '        , :xSALESAMOUNT_95'
      '        , :xSALESAMOUNT_96'
      '        , :xSALESAMOUNT_97'
      '        , :xSALESAMOUNT_98'
      '        , :xSALESAMOUNT_99'
      '        , :xSALESAMOUNT_100'
      '        , :xSALESAMOUNT_101'
      '        , :xSALESAMOUNT_102'
      '        , :xSALESAMOUNT_103'
      '        , :xSALESAMOUNT_104'
      '        , :xSALESAMOUNT_105'
      '        , :xSALESAMOUNT_106'
      '        , :xSALESAMOUNT_107'
      '        , :xSALESAMOUNT_108'
      '        , :xSALESAMOUNT_109'
      '        , :xSALESAMOUNT_110'
      '        , :xSALESAMOUNT_111'
      '        , :xSALESAMOUNT_112'
      '        , :xSALESAMOUNT_113'
      '        , :xSALESAMOUNT_114'
      '        , :xSALESAMOUNT_115'
      '        , :xSALESAMOUNT_116'
      '        , :xSALESAMOUNT_117'
      '        , :xSALESAMOUNT_118'
      '        , :xSALESAMOUNT_119'
      '        , :xSALESAMOUNT_120'
      '  Do Begin'
      '     /* Replace Sales */'
      '     if (ReplaceInd = '#39'R'#39') then'
      '     begin'
      '       Update ItemSales'
      '        Set SALESAMOUNT_0  =:xSALESAMOUNT_0'
      '          , SALESAMOUNT_1  =:xSALESAMOUNT_1'
      '          , SALESAMOUNT_2  =:xSALESAMOUNT_2'
      '          , SALESAMOUNT_3  =:xSALESAMOUNT_3'
      '          , SALESAMOUNT_4  =:xSALESAMOUNT_4'
      '          , SALESAMOUNT_5  =:xSALESAMOUNT_5'
      '          , SALESAMOUNT_6  =:xSALESAMOUNT_6'
      '          , SALESAMOUNT_7  =:xSALESAMOUNT_7'
      '          , SALESAMOUNT_8  =:xSALESAMOUNT_8'
      '          , SALESAMOUNT_9  =:xSALESAMOUNT_9'
      '          , SALESAMOUNT_10 =:xSALESAMOUNT_10'
      '          , SALESAMOUNT_11 =:xSALESAMOUNT_11'
      '          , SALESAMOUNT_12 =:xSALESAMOUNT_12'
      '          , SALESAMOUNT_13 =:xSALESAMOUNT_13'
      '          , SALESAMOUNT_14 =:xSALESAMOUNT_14'
      '          , SALESAMOUNT_15 =:xSALESAMOUNT_15'
      '          , SALESAMOUNT_16 =:xSALESAMOUNT_16'
      '          , SALESAMOUNT_17 =:xSALESAMOUNT_17'
      '          , SALESAMOUNT_18 =:xSALESAMOUNT_18'
      '          , SALESAMOUNT_19 =:xSALESAMOUNT_19'
      '          , SALESAMOUNT_20 =:xSALESAMOUNT_20'
      '          , SALESAMOUNT_21 =:xSALESAMOUNT_21'
      '          , SALESAMOUNT_22 =:xSALESAMOUNT_22'
      '          , SALESAMOUNT_23 =:xSALESAMOUNT_23'
      '          , SALESAMOUNT_24 =:xSALESAMOUNT_24'
      '          , SALESAMOUNT_25 =:xSALESAMOUNT_25'
      '          , SALESAMOUNT_26 =:xSALESAMOUNT_26'
      '          , SALESAMOUNT_27 =:xSALESAMOUNT_27'
      '          , SALESAMOUNT_28 =:xSALESAMOUNT_28'
      '          , SALESAMOUNT_29 =:xSALESAMOUNT_29'
      '          , SALESAMOUNT_30 =:xSALESAMOUNT_30'
      '          , SALESAMOUNT_31 =:xSALESAMOUNT_31'
      '          , SALESAMOUNT_32 =:xSALESAMOUNT_32'
      '          , SALESAMOUNT_33 =:xSALESAMOUNT_33'
      '          , SALESAMOUNT_34 =:xSALESAMOUNT_34'
      '          , SALESAMOUNT_35 =:xSALESAMOUNT_35'
      '          , SALESAMOUNT_36 =:xSALESAMOUNT_36'
      '          , SALESAMOUNT_37 =:xSALESAMOUNT_37'
      '          , SALESAMOUNT_38 =:xSALESAMOUNT_38'
      '          , SALESAMOUNT_39 =:xSALESAMOUNT_39'
      '          , SALESAMOUNT_40 =:xSALESAMOUNT_40'
      '          , SALESAMOUNT_41 =:xSALESAMOUNT_41'
      '          , SALESAMOUNT_42 =:xSALESAMOUNT_42'
      '          , SALESAMOUNT_43 =:xSALESAMOUNT_43'
      '          , SALESAMOUNT_44 =:xSALESAMOUNT_44'
      '          , SALESAMOUNT_45 =:xSALESAMOUNT_45'
      '          , SALESAMOUNT_46 =:xSALESAMOUNT_46'
      '          , SALESAMOUNT_47 =:xSALESAMOUNT_47'
      '          , SALESAMOUNT_48 =:xSALESAMOUNT_48'
      '          , SALESAMOUNT_49 =:xSALESAMOUNT_49'
      '          , SALESAMOUNT_50 =:xSALESAMOUNT_50'
      '          , SALESAMOUNT_51 =:xSALESAMOUNT_51'
      '          , SALESAMOUNT_52 =:xSALESAMOUNT_52'
      '          , SALESAMOUNT_53 =:xSALESAMOUNT_53'
      '          , SALESAMOUNT_54 =:xSALESAMOUNT_54'
      '          , SALESAMOUNT_55 =:xSALESAMOUNT_55'
      '          , SALESAMOUNT_56 =:xSALESAMOUNT_56'
      '          , SALESAMOUNT_57 =:xSALESAMOUNT_57'
      '          , SALESAMOUNT_58 =:xSALESAMOUNT_58'
      '          , SALESAMOUNT_59 =:xSALESAMOUNT_59'
      '          , SALESAMOUNT_60 =:xSALESAMOUNT_60'
      '          , SALESAMOUNT_61 =:xSALESAMOUNT_61'
      '          , SALESAMOUNT_62 =:xSALESAMOUNT_62'
      '          , SALESAMOUNT_63 =:xSALESAMOUNT_63'
      '          , SALESAMOUNT_64 =:xSALESAMOUNT_64'
      '          , SALESAMOUNT_65 =:xSALESAMOUNT_65'
      '          , SALESAMOUNT_66 =:xSALESAMOUNT_66'
      '          , SALESAMOUNT_67 =:xSALESAMOUNT_67'
      '          , SALESAMOUNT_68 =:xSALESAMOUNT_68'
      '          , SALESAMOUNT_69 =:xSALESAMOUNT_69'
      '          , SALESAMOUNT_70 =:xSALESAMOUNT_70'
      '          , SALESAMOUNT_71 =:xSALESAMOUNT_71'
      '          , SALESAMOUNT_72 =:xSALESAMOUNT_72'
      '          , SALESAMOUNT_73 =:xSALESAMOUNT_73'
      '          , SALESAMOUNT_74 =:xSALESAMOUNT_74'
      '          , SALESAMOUNT_75 =:xSALESAMOUNT_75'
      '          , SALESAMOUNT_76 =:xSALESAMOUNT_76'
      '          , SALESAMOUNT_77 =:xSALESAMOUNT_77'
      '          , SALESAMOUNT_78 =:xSALESAMOUNT_78'
      '          , SALESAMOUNT_80 =:xSALESAMOUNT_80'
      '          , SALESAMOUNT_81 =:xSALESAMOUNT_81'
      '          , SALESAMOUNT_82 =:xSALESAMOUNT_82'
      '          , SALESAMOUNT_83 =:xSALESAMOUNT_83'
      '          , SALESAMOUNT_84 =:xSALESAMOUNT_84'
      '          , SALESAMOUNT_85 =:xSALESAMOUNT_85'
      '          , SALESAMOUNT_86 =:xSALESAMOUNT_86'
      '          , SALESAMOUNT_87 =:xSALESAMOUNT_87'
      '          , SALESAMOUNT_88 =:xSALESAMOUNT_88'
      '          , SALESAMOUNT_89 =:xSALESAMOUNT_89'
      '          , SALESAMOUNT_90 =:xSALESAMOUNT_90'
      '          , SALESAMOUNT_91 =:xSALESAMOUNT_91'
      '          , SALESAMOUNT_92 =:xSALESAMOUNT_92'
      '          , SALESAMOUNT_93 =:xSALESAMOUNT_93'
      '          , SALESAMOUNT_94 =:xSALESAMOUNT_94'
      '          , SALESAMOUNT_95 =:xSALESAMOUNT_95'
      '          , SALESAMOUNT_96 =:xSALESAMOUNT_96'
      '          , SALESAMOUNT_97 =:xSALESAMOUNT_97'
      '          , SALESAMOUNT_98 =:xSALESAMOUNT_98'
      '          , SALESAMOUNT_99 =:xSALESAMOUNT_99'
      '          , SALESAMOUNT_100=:xSALESAMOUNT_100'
      '          , SALESAMOUNT_101=:xSALESAMOUNT_101'
      '          , SALESAMOUNT_102=:xSALESAMOUNT_102'
      '          , SALESAMOUNT_103=:xSALESAMOUNT_103'
      '          , SALESAMOUNT_104=:xSALESAMOUNT_104'
      '          , SALESAMOUNT_105=:xSALESAMOUNT_105'
      '          , SALESAMOUNT_106=:xSALESAMOUNT_106'
      '          , SALESAMOUNT_107=:xSALESAMOUNT_107'
      '          , SALESAMOUNT_108=:xSALESAMOUNT_108'
      '          , SALESAMOUNT_109=:xSALESAMOUNT_109'
      '          , SALESAMOUNT_110=:xSALESAMOUNT_110'
      '          , SALESAMOUNT_111=:xSALESAMOUNT_111'
      '          , SALESAMOUNT_112=:xSALESAMOUNT_112'
      '          , SALESAMOUNT_113=:xSALESAMOUNT_113'
      '          , SALESAMOUNT_114=:xSALESAMOUNT_114'
      '          , SALESAMOUNT_115=:xSALESAMOUNT_115'
      '          , SALESAMOUNT_116=:xSALESAMOUNT_116'
      '          , SALESAMOUNT_117=:xSALESAMOUNT_117'
      '          , SALESAMOUNT_118=:xSALESAMOUNT_118'
      '          , SALESAMOUNT_119=:xSALESAMOUNT_119'
      '          , SALESAMOUNT_120=:xSALESAMOUNT_120'
      '        where Itemno = :xTargetItemNo;'
      '      end'
      ''
      '     /* Add to existing Sales */'
      '     if (ReplaceInd = '#39'A'#39') then'
      '     begin'
      '     Update ItemSales'
      '        Set SALESAMOUNT_0  =SALESAMOUNT_0   + :xSALESAMOUNT_0'
      '          , SALESAMOUNT_1  =SALESAMOUNT_1   + :xSALESAMOUNT_1'
      '          , SALESAMOUNT_2  =SALESAMOUNT_2   + :xSALESAMOUNT_2'
      '          , SALESAMOUNT_3  =SALESAMOUNT_3   + :xSALESAMOUNT_3'
      '          , SALESAMOUNT_4  =SALESAMOUNT_4   + :xSALESAMOUNT_4'
      '          , SALESAMOUNT_5  =SALESAMOUNT_5   + :xSALESAMOUNT_5'
      '          , SALESAMOUNT_6  =SALESAMOUNT_6   + :xSALESAMOUNT_6'
      '          , SALESAMOUNT_7  =SALESAMOUNT_7   + :xSALESAMOUNT_7'
      '          , SALESAMOUNT_8  =SALESAMOUNT_8   + :xSALESAMOUNT_8'
      '          , SALESAMOUNT_9  =SALESAMOUNT_9   + :xSALESAMOUNT_9'
      '          , SALESAMOUNT_10 =SALESAMOUNT_10  + :xSALESAMOUNT_10'
      '          , SALESAMOUNT_11 =SALESAMOUNT_11  + :xSALESAMOUNT_11'
      '          , SALESAMOUNT_12 =SALESAMOUNT_12  + :xSALESAMOUNT_12'
      '          , SALESAMOUNT_13 =SALESAMOUNT_13  + :xSALESAMOUNT_13'
      '          , SALESAMOUNT_14 =SALESAMOUNT_14  + :xSALESAMOUNT_14'
      '          , SALESAMOUNT_15 =SALESAMOUNT_15  + :xSALESAMOUNT_15'
      '          , SALESAMOUNT_16 =SALESAMOUNT_16  + :xSALESAMOUNT_16'
      '          , SALESAMOUNT_17 =SALESAMOUNT_17  + :xSALESAMOUNT_17'
      '          , SALESAMOUNT_18 =SALESAMOUNT_18  + :xSALESAMOUNT_18'
      '          , SALESAMOUNT_19 =SALESAMOUNT_19  + :xSALESAMOUNT_19'
      '          , SALESAMOUNT_20 =SALESAMOUNT_20  + :xSALESAMOUNT_20'
      '          , SALESAMOUNT_21 =SALESAMOUNT_21  + :xSALESAMOUNT_21'
      '          , SALESAMOUNT_22 =SALESAMOUNT_22  + :xSALESAMOUNT_22'
      '          , SALESAMOUNT_23 =SALESAMOUNT_23  + :xSALESAMOUNT_23'
      '          , SALESAMOUNT_24 =SALESAMOUNT_24  + :xSALESAMOUNT_24'
      '          , SALESAMOUNT_25 =SALESAMOUNT_25  + :xSALESAMOUNT_25'
      '          , SALESAMOUNT_26 =SALESAMOUNT_26  + :xSALESAMOUNT_26'
      '          , SALESAMOUNT_27 =SALESAMOUNT_27  + :xSALESAMOUNT_27'
      '          , SALESAMOUNT_28 =SALESAMOUNT_28  + :xSALESAMOUNT_28'
      '          , SALESAMOUNT_29 =SALESAMOUNT_29  + :xSALESAMOUNT_29'
      '          , SALESAMOUNT_30 =SALESAMOUNT_30  + :xSALESAMOUNT_30'
      '          , SALESAMOUNT_31 =SALESAMOUNT_31  + :xSALESAMOUNT_31'
      '          , SALESAMOUNT_32 =SALESAMOUNT_32  + :xSALESAMOUNT_32'
      '          , SALESAMOUNT_33 =SALESAMOUNT_33  + :xSALESAMOUNT_33'
      '          , SALESAMOUNT_34 =SALESAMOUNT_34  + :xSALESAMOUNT_34'
      '          , SALESAMOUNT_35 =SALESAMOUNT_35  + :xSALESAMOUNT_35'
      '          , SALESAMOUNT_36 =SALESAMOUNT_36  + :xSALESAMOUNT_36'
      '          , SALESAMOUNT_37 =SALESAMOUNT_37  + :xSALESAMOUNT_37'
      '          , SALESAMOUNT_38 =SALESAMOUNT_38  + :xSALESAMOUNT_38'
      '          , SALESAMOUNT_39 =SALESAMOUNT_39  + :xSALESAMOUNT_39'
      '          , SALESAMOUNT_40 =SALESAMOUNT_40  + :xSALESAMOUNT_40'
      '          , SALESAMOUNT_41 =SALESAMOUNT_41  + :xSALESAMOUNT_41'
      '          , SALESAMOUNT_42 =SALESAMOUNT_42  + :xSALESAMOUNT_42'
      '          , SALESAMOUNT_43 =SALESAMOUNT_43  + :xSALESAMOUNT_43'
      '          , SALESAMOUNT_44 =SALESAMOUNT_44  + :xSALESAMOUNT_44'
      '          , SALESAMOUNT_45 =SALESAMOUNT_45  + :xSALESAMOUNT_45'
      '          , SALESAMOUNT_46 =SALESAMOUNT_46  + :xSALESAMOUNT_46'
      '          , SALESAMOUNT_47 =SALESAMOUNT_47  + :xSALESAMOUNT_47'
      '          , SALESAMOUNT_48 =SALESAMOUNT_48  + :xSALESAMOUNT_48'
      '          , SALESAMOUNT_49 =SALESAMOUNT_49  + :xSALESAMOUNT_49'
      '          , SALESAMOUNT_50 =SALESAMOUNT_50  + :xSALESAMOUNT_50'
      '          , SALESAMOUNT_51 =SALESAMOUNT_51  + :xSALESAMOUNT_51'
      '          , SALESAMOUNT_52 =SALESAMOUNT_52  + :xSALESAMOUNT_52'
      '          , SALESAMOUNT_53 =SALESAMOUNT_53  + :xSALESAMOUNT_53'
      '          , SALESAMOUNT_54 =SALESAMOUNT_54  + :xSALESAMOUNT_54'
      '          , SALESAMOUNT_55 =SALESAMOUNT_55  + :xSALESAMOUNT_55'
      '          , SALESAMOUNT_56 =SALESAMOUNT_56  + :xSALESAMOUNT_56'
      '          , SALESAMOUNT_57 =SALESAMOUNT_57  + :xSALESAMOUNT_57'
      '          , SALESAMOUNT_58 =SALESAMOUNT_58  + :xSALESAMOUNT_58'
      '          , SALESAMOUNT_59 =SALESAMOUNT_59  + :xSALESAMOUNT_59'
      '          , SALESAMOUNT_60 =SALESAMOUNT_60  + :xSALESAMOUNT_60'
      '          , SALESAMOUNT_61 =SALESAMOUNT_61  + :xSALESAMOUNT_61'
      '          , SALESAMOUNT_62 =SALESAMOUNT_62  + :xSALESAMOUNT_62'
      '          , SALESAMOUNT_63 =SALESAMOUNT_63  + :xSALESAMOUNT_63'
      '          , SALESAMOUNT_64 =SALESAMOUNT_64  + :xSALESAMOUNT_64'
      '          , SALESAMOUNT_65 =SALESAMOUNT_65  + :xSALESAMOUNT_65'
      '          , SALESAMOUNT_66 =SALESAMOUNT_66  + :xSALESAMOUNT_66'
      '          , SALESAMOUNT_67 =SALESAMOUNT_67  + :xSALESAMOUNT_67'
      '          , SALESAMOUNT_68 =SALESAMOUNT_68  + :xSALESAMOUNT_68'
      '          , SALESAMOUNT_69 =SALESAMOUNT_69  + :xSALESAMOUNT_69'
      '          , SALESAMOUNT_70 =SALESAMOUNT_70  + :xSALESAMOUNT_70'
      '          , SALESAMOUNT_71 =SALESAMOUNT_71  + :xSALESAMOUNT_71'
      '          , SALESAMOUNT_72 =SALESAMOUNT_72  + :xSALESAMOUNT_72'
      '          , SALESAMOUNT_73 =SALESAMOUNT_73  + :xSALESAMOUNT_73'
      '          , SALESAMOUNT_74 =SALESAMOUNT_74  + :xSALESAMOUNT_74'
      '          , SALESAMOUNT_75 =SALESAMOUNT_75  + :xSALESAMOUNT_75'
      '          , SALESAMOUNT_76 =SALESAMOUNT_76  + :xSALESAMOUNT_76'
      '          , SALESAMOUNT_77 =SALESAMOUNT_77  + :xSALESAMOUNT_77'
      '          , SALESAMOUNT_78 =SALESAMOUNT_78  + :xSALESAMOUNT_78'
      '          , SALESAMOUNT_80 =SALESAMOUNT_80  + :xSALESAMOUNT_80'
      '          , SALESAMOUNT_81 =SALESAMOUNT_81  + :xSALESAMOUNT_81'
      '          , SALESAMOUNT_82 =SALESAMOUNT_82  + :xSALESAMOUNT_82'
      '          , SALESAMOUNT_83 =SALESAMOUNT_83  + :xSALESAMOUNT_83'
      '          , SALESAMOUNT_84 =SALESAMOUNT_84  + :xSALESAMOUNT_84'
      '          , SALESAMOUNT_85 =SALESAMOUNT_85  + :xSALESAMOUNT_85'
      '          , SALESAMOUNT_86 =SALESAMOUNT_86  + :xSALESAMOUNT_86'
      '          , SALESAMOUNT_87 =SALESAMOUNT_87  + :xSALESAMOUNT_87'
      '          , SALESAMOUNT_88 =SALESAMOUNT_88  + :xSALESAMOUNT_88'
      '          , SALESAMOUNT_89 =SALESAMOUNT_89  + :xSALESAMOUNT_89'
      '          , SALESAMOUNT_90 =SALESAMOUNT_90  + :xSALESAMOUNT_90'
      '          , SALESAMOUNT_91 =SALESAMOUNT_91  + :xSALESAMOUNT_91'
      '          , SALESAMOUNT_92 =SALESAMOUNT_92  + :xSALESAMOUNT_92'
      '          , SALESAMOUNT_93 =SALESAMOUNT_93  + :xSALESAMOUNT_93'
      '          , SALESAMOUNT_94 =SALESAMOUNT_94  + :xSALESAMOUNT_94'
      '          , SALESAMOUNT_95 =SALESAMOUNT_95  + :xSALESAMOUNT_95'
      '          , SALESAMOUNT_96 =SALESAMOUNT_96  + :xSALESAMOUNT_96'
      '          , SALESAMOUNT_97 =SALESAMOUNT_97  + :xSALESAMOUNT_97'
      '          , SALESAMOUNT_98 =SALESAMOUNT_98  + :xSALESAMOUNT_98'
      '          , SALESAMOUNT_99 =SALESAMOUNT_99  + :xSALESAMOUNT_99'
      '          , SALESAMOUNT_100=SALESAMOUNT_100 + :xSALESAMOUNT_100'
      '          , SALESAMOUNT_101=SALESAMOUNT_101 + :xSALESAMOUNT_101'
      '          , SALESAMOUNT_102=SALESAMOUNT_102 + :xSALESAMOUNT_102'
      '          , SALESAMOUNT_103=SALESAMOUNT_103 + :xSALESAMOUNT_103'
      '          , SALESAMOUNT_104=SALESAMOUNT_104 + :xSALESAMOUNT_104'
      '          , SALESAMOUNT_105=SALESAMOUNT_105 + :xSALESAMOUNT_105'
      '          , SALESAMOUNT_106=SALESAMOUNT_106 + :xSALESAMOUNT_106'
      '          , SALESAMOUNT_107=SALESAMOUNT_107 + :xSALESAMOUNT_107'
      '          , SALESAMOUNT_108=SALESAMOUNT_108 + :xSALESAMOUNT_108'
      '          , SALESAMOUNT_109=SALESAMOUNT_109 + :xSALESAMOUNT_109'
      '          , SALESAMOUNT_110=SALESAMOUNT_110 + :xSALESAMOUNT_110'
      '          , SALESAMOUNT_111=SALESAMOUNT_111 + :xSALESAMOUNT_111'
      '          , SALESAMOUNT_112=SALESAMOUNT_112 + :xSALESAMOUNT_112'
      '          , SALESAMOUNT_113=SALESAMOUNT_113 + :xSALESAMOUNT_113'
      '          , SALESAMOUNT_114=SALESAMOUNT_114 + :xSALESAMOUNT_114'
      '          , SALESAMOUNT_115=SALESAMOUNT_115 + :xSALESAMOUNT_115'
      '          , SALESAMOUNT_116=SALESAMOUNT_116 + :xSALESAMOUNT_116'
      '          , SALESAMOUNT_117=SALESAMOUNT_117 + :xSALESAMOUNT_117'
      '          , SALESAMOUNT_118=SALESAMOUNT_118 + :xSALESAMOUNT_118'
      '          , SALESAMOUNT_119=SALESAMOUNT_119 + :xSALESAMOUNT_119'
      '          , SALESAMOUNT_120=SALESAMOUNT_120 + :xSALESAMOUNT_120'
      '       where Itemno = :xTargetItemNo;'
      '     end'
      ''
      '     /* Update Age with maximum of source and target*/'
      '      Update Item'
      '          Set AGE = :xTargetAge'
      '          where ItemNo = :xTargetItemNo;'
      '  end'
      'end')
    Transaction = trnOptimiza
    Left = 128
    Top = 224
  end
  object prcUpdateSales: TIBStoredProc
    Database = dbOptimiza
    Transaction = trnOptimiza
    StoredProcName = 'UP_COPYSALES'
    Left = 224
    Top = 224
    ParamData = <
      item
        DataType = ftString
        Name = 'SOURCELOCATIONCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'TARGETLOCATIONCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'SOURCEPRODUCTCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'TARGETPRODUCTCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'REPLACEIND'
        ParamType = ptInput
      end>
  end
  object qryCheckTarget: TIBQuery
    Database = dbOptimiza
    Transaction = trnOptimiza
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select itemno from'
      'item where productno = (Select productno from product'
      '  where productCode = :ProdCode)'
      '  and locationno = (Select LocationNo from Location'
      '  where LocationCode = :LocCode)')
    Left = 208
    Top = 144
    ParamData = <
      item
        DataType = ftString
        Name = 'ProdCode'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'LocCode'
        ParamType = ptUnknown
      end>
  end
  object prcCopyFC: TIBStoredProc
    Database = dbOptimiza
    Transaction = trnOptimiza
    StoredProcName = 'UP_COPYFC_BY_PERC'
    Left = 232
    Top = 296
    ParamData = <
      item
        DataType = ftString
        Name = 'SOURCELOCATIONCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'TARGETLOCATIONCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'SOURCEPRODUCTCODE'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'TARGETPRODUCTCODE'
        ParamType = ptInput
      end
      item
        DataType = ftInteger
        Name = 'MONTHCOUNT'
        ParamType = ptInput
      end
      item
        DataType = ftInteger
        Name = 'OFFSET'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'FREEZEIND'
        ParamType = ptInput
      end
      item
        DataType = ftString
        Name = 'ADDIND'
        ParamType = ptInput
      end
      item
        DataType = ftFloat
        Name = 'PERC'
        ParamType = ptInput
      end>
  end
  object qryCheckProc2: TIBSQL
    Database = dbOptimiza
    ParamCheck = False
    SQL.Strings = (
      'Select * from rdb$procedures where'
      'RDB$PROCEDURE_NAME = "UP_COPYFC_BY_PERC"')
    Transaction = trnOptimiza
    Left = 32
    Top = 296
  end
  object qryAddStoredProc2: TIBSQL
    Database = dbOptimiza
    ParamCheck = False
    SQL.Strings = (
      
        'create procedure up_copyfc_by_perc (SOURCELOCATIONCODE varchar(1' +
        '0), TARGETLOCATIONCODE varchar(10),'
      
        ' SOURCEPRODUCTCODE varchar(30), TARGETPRODUCTCODE varchar(30), M' +
        'ONTHCOUNT integer,'
      
        ' OFFSET integer, FREEZEIND varchar(1), ADDIND varchar(1), perc d' +
        'ouble precision)'
      'as'
      'declare variable xSourceItem      Integer;'
      '  declare variable xTargetItem      Integer;'
      '  declare variable xLocationNo      Integer;'
      '  declare variable xProductNo       Integer;'
      '  declare variable xCalendarNo integer;'
      '  declare variable xsfFORECAST_0    CHAR(1) ;'
      '  declare variable xsfFORECAST_1    CHAR(1) ;'
      '  declare variable xsfFORECAST_2    CHAR(1) ;'
      '  declare variable xsfFORECAST_3    CHAR(1) ;'
      '  declare variable xsfFORECAST_4    CHAR(1) ;'
      '  declare variable xsfFORECAST_5    CHAR(1) ;'
      '  declare variable xsfFORECAST_6    CHAR(1) ;'
      '  declare variable xsfFORECAST_7    CHAR(1) ;'
      '  declare variable xsfFORECAST_8    CHAR(1) ;'
      '  declare variable xsfFORECAST_9    CHAR(1) ;'
      '  declare variable xsfFORECAST_10   CHAR(1) ;'
      '  declare variable xsfFORECAST_11   CHAR(1) ;'
      '  declare variable xsfFORECAST_12   CHAR(1) ;'
      '  declare variable xsfFORECAST_13   CHAR(1) ;'
      '  declare variable xsfFORECAST_14   CHAR(1) ;'
      '  declare variable xsfFORECAST_15   CHAR(1) ;'
      '  declare variable xsfFORECAST_16   CHAR(1) ;'
      '  declare variable xsfFORECAST_17   CHAR(1) ;'
      '  declare variable xsfFORECAST_18   CHAR(1) ;'
      '  declare variable xsfFORECAST_19   CHAR(1) ;'
      '  declare variable xsfFORECAST_20   CHAR(1) ;'
      '  declare variable xsfFORECAST_21   CHAR(1) ;'
      '  declare variable xsfFORECAST_22   CHAR(1) ;'
      '  declare variable xsfFORECAST_23   CHAR(1) ;'
      '  declare variable xsfFORECAST_24   CHAR(1) ;'
      '  declare variable xsfFORECAST_25   CHAR(1) ;'
      ''
      '  declare variable xtfFORECAST_0    CHAR(1) ;'
      '  declare variable xtfFORECAST_1    CHAR(1) ;'
      '  declare variable xtfFORECAST_2    CHAR(1) ;'
      '  declare variable xtfFORECAST_3    CHAR(1) ;'
      '  declare variable xtfFORECAST_4    CHAR(1) ;'
      '  declare variable xtfFORECAST_5    CHAR(1) ;'
      '  declare variable xtfFORECAST_6    CHAR(1) ;'
      '  declare variable xtfFORECAST_7    CHAR(1) ;'
      '  declare variable xtfFORECAST_8    CHAR(1) ;'
      '  declare variable xtfFORECAST_9    CHAR(1) ;'
      '  declare variable xtfFORECAST_10   CHAR(1) ;'
      '  declare variable xtfFORECAST_11   CHAR(1) ;'
      '  declare variable xtfFORECAST_12   CHAR(1) ;'
      '  declare variable xtfFORECAST_13   CHAR(1) ;'
      '  declare variable xtfFORECAST_14   CHAR(1) ;'
      '  declare variable xtfFORECAST_15   CHAR(1) ;'
      '  declare variable xtfFORECAST_16   CHAR(1) ;'
      '  declare variable xtfFORECAST_17   CHAR(1) ;'
      '  declare variable xtfFORECAST_18   CHAR(1) ;'
      '  declare variable xtfFORECAST_19   CHAR(1) ;'
      '  declare variable xtfFORECAST_20   CHAR(1) ;'
      '  declare variable xtfFORECAST_21   CHAR(1) ;'
      '  declare variable xtfFORECAST_22   CHAR(1) ;'
      '  declare variable xtfFORECAST_23   CHAR(1) ;'
      '  declare variable xtfFORECAST_24   CHAR(1) ;'
      '  declare variable xtfFORECAST_25   CHAR(1) ;'
      ''
      '  declare variable xsnFORECAST_0    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_1    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_2    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_3    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_4    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_5    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_6    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_7    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_8    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_9    DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_10   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_11   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_12   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_13   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_14   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_15   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_16   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_17   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_18   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_19   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_20   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_21   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_22   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_23   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_24   DOUBLE PRECISION;'
      '  declare variable xsnFORECAST_25   DOUBLE PRECISION;'
      ''
      '  declare variable xtnFORECAST_0    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_1    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_2    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_3    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_4    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_5    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_6    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_7    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_8    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_9    DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_10   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_11   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_12   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_13   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_14   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_15   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_16   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_17   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_18   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_19   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_20   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_21   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_22   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_23   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_24   DOUBLE PRECISION;'
      '  declare variable xtnFORECAST_25   DOUBLE PRECISION;'
      ''
      'begin'
      ''
      'SELECT TypeOfInteger FROM Configuration'
      '  WHERE ConfigurationNo = 100'
      '   Into :xCalendarNo;'
      '   '
      'Perc = Perc / 100;'
      ''
      ''
      'Select ItemNo From Item'
      '  Where LocationNo = (Select LocationNO From Location'
      '                      where LocationCode = :SOURCELOCATIONCODE)'
      '  and ProductNo = (Select ProductNo From Product'
      '                    where ProductCode = :SOURCEPRODUCTCODE)'
      '      into :xSourceItem;'
      ''
      'Select ItemNo From Item'
      '  Where LocationNo = (Select LocationNO From Location'
      '                      where LocationCode = :TargetLOCATIONCODE)'
      '  and ProductNo = (Select ProductNo From Product'
      '                    where ProductCode = :TARGETPRODUCTCODE)'
      '      into :xTargetItem;'
      ''
      'Select        tf.FORECAST_0'
      '                , tf.FORECAST_1'
      '                , tf.FORECAST_2'
      '                , tf.FORECAST_3'
      '                , tf.FORECAST_4'
      '                , tf.FORECAST_5'
      '                , tf.FORECAST_6'
      '                , tf.FORECAST_7'
      '                , tf.FORECAST_8'
      '                , tf.FORECAST_9'
      '                , tf.FORECAST_10'
      '                , tf.FORECAST_11'
      '                , tf.FORECAST_12'
      '                , tf.FORECAST_13'
      '                , tf.FORECAST_14'
      '                , tf.FORECAST_15'
      '                , tf.FORECAST_16'
      '                , tf.FORECAST_17'
      '                , tf.FORECAST_18'
      '                , tf.FORECAST_19'
      '                , tf.FORECAST_20'
      '                , tf.FORECAST_21'
      '                , tf.FORECAST_22'
      '                , tf.FORECAST_23'
      '                , tf.FORECAST_24'
      '                , tf.FORECAST_25'
      ''
      ''
      '                , tn.FORECAST_0'
      '                , tn.FORECAST_1'
      '                , tn.FORECAST_2'
      '                , tn.FORECAST_3'
      '                , tn.FORECAST_4'
      '                , tn.FORECAST_5'
      '                , tn.FORECAST_6'
      '                , tn.FORECAST_7'
      '                , tn.FORECAST_8'
      '                , tn.FORECAST_9'
      '                , tn.FORECAST_10'
      '                , tn.FORECAST_11'
      '                , tn.FORECAST_12'
      '                , tn.FORECAST_13'
      '                , tn.FORECAST_14'
      '                , tn.FORECAST_15'
      '                , tn.FORECAST_16'
      '                , tn.FORECAST_17'
      '                , tn.FORECAST_18'
      '                , tn.FORECAST_19'
      '                , tn.FORECAST_20'
      '                , tn.FORECAST_21'
      '                , tn.FORECAST_22'
      '                , tn.FORECAST_23'
      '                , tn.FORECAST_24'
      '                , tn.FORECAST_25'
      ''
      '       From ItemFrozenForecast tf'
      '           , ItemForecast tn'
      '           where tf.itemno = :xTargetItem'
      '           and tn.itemno = :xTargetItem'
      '           and tn.CalendarNo = :xCalendarNo'
      '           and tf.CalendarNo = :xCalendarNo'
      '           and tn.ForecastTypeNo = 1'
      ''
      ''
      '                Into :xtfFORECAST_0'
      '                , :xtfFORECAST_1'
      '                , :xtfFORECAST_2'
      '                , :xtfFORECAST_3'
      '                , :xtfFORECAST_4'
      '                , :xtfFORECAST_5'
      '                , :xtfFORECAST_6'
      '                , :xtfFORECAST_7'
      '                , :xtfFORECAST_8'
      '                , :xtfFORECAST_9'
      '                , :xtfFORECAST_10'
      '                , :xtfFORECAST_11'
      '                , :xtfFORECAST_12'
      '                , :xtfFORECAST_13'
      '                , :xtfFORECAST_14'
      '                , :xtfFORECAST_15'
      '                , :xtfFORECAST_16'
      '                , :xtfFORECAST_17'
      '                , :xtfFORECAST_18'
      '                , :xtfFORECAST_19'
      '                , :xtfFORECAST_20'
      '                , :xtfFORECAST_21'
      '                , :xtfFORECAST_22'
      '                , :xtfFORECAST_23'
      '                , :xtfFORECAST_24'
      '                , :xtfFORECAST_25'
      ''
      '                , :xtnFORECAST_0'
      '                , :xtnFORECAST_1'
      '                , :xtnFORECAST_2'
      '                , :xtnFORECAST_3'
      '                , :xtnFORECAST_4'
      '                , :xtnFORECAST_5'
      '                , :xtnFORECAST_6'
      '                , :xtnFORECAST_7'
      '                , :xtnFORECAST_8'
      '                , :xtnFORECAST_9'
      '                , :xtnFORECAST_10'
      '                , :xtnFORECAST_11'
      '                , :xtnFORECAST_12'
      '                , :xtnFORECAST_13'
      '                , :xtnFORECAST_14'
      '                , :xtnFORECAST_15'
      '                , :xtnFORECAST_16'
      '                , :xtnFORECAST_17'
      '                , :xtnFORECAST_18'
      '                , :xtnFORECAST_19'
      '                , :xtnFORECAST_20'
      '                , :xtnFORECAST_21'
      '                , :xtnFORECAST_22'
      '                , :xtnFORECAST_23'
      '                , :xtnFORECAST_24'
      '                , :xtnFORECAST_25;'
      ''
      ''
      'Select        sf.FORECAST_0'
      '                , sf.FORECAST_1'
      '                , sf.FORECAST_2'
      '                , sf.FORECAST_3'
      '                , sf.FORECAST_4'
      '                , sf.FORECAST_5'
      '                , sf.FORECAST_6'
      '                , sf.FORECAST_7'
      '                , sf.FORECAST_8'
      '                , sf.FORECAST_9'
      '                , sf.FORECAST_10'
      '                , sf.FORECAST_11'
      '                , sf.FORECAST_12'
      '                , sf.FORECAST_13'
      '                , sf.FORECAST_14'
      '                , sf.FORECAST_15'
      '                , sf.FORECAST_16'
      '                , sf.FORECAST_17'
      '                , sf.FORECAST_18'
      '                , sf.FORECAST_19'
      '                , sf.FORECAST_20'
      '                , sf.FORECAST_21'
      '                , sf.FORECAST_22'
      '                , sf.FORECAST_23'
      '                , sf.FORECAST_24'
      '                , sf.FORECAST_25'
      ''
      '                , sn.FORECAST_0 * :Perc'
      '                , sn.FORECAST_1 * :Perc'
      '                , sn.FORECAST_2 * :Perc'
      '                , sn.FORECAST_3 * :Perc'
      '                , sn.FORECAST_4 * :Perc'
      '                , sn.FORECAST_5 * :Perc'
      '                , sn.FORECAST_6 * :Perc'
      '                , sn.FORECAST_7 * :Perc'
      '                , sn.FORECAST_8 * :Perc'
      '                , sn.FORECAST_9 * :Perc'
      '                , sn.FORECAST_10 * :Perc'
      '                , sn.FORECAST_11 * :Perc'
      '                , sn.FORECAST_12 * :Perc'
      '                , sn.FORECAST_13 * :Perc'
      '                , sn.FORECAST_14 * :Perc'
      '                , sn.FORECAST_15 * :Perc'
      '                , sn.FORECAST_16 * :Perc'
      '                , sn.FORECAST_17 * :Perc'
      '                , sn.FORECAST_18 * :Perc'
      '                , sn.FORECAST_19 * :Perc'
      '                , sn.FORECAST_20 * :Perc'
      '                , sn.FORECAST_21 * :Perc'
      '                , sn.FORECAST_22 * :Perc'
      '                , sn.FORECAST_23 * :Perc'
      '                , sn.FORECAST_24 * :Perc'
      '                , sn.FORECAST_25 * :Perc'
      ''
      ''
      '       From ItemFrozenForecast sf'
      '           , ItemForecast sn'
      '           where sf.itemno = :xSourceItem'
      '           and sn.itemno = :xSourceItem'
      '           and sn.CalendarNo = :xCalendarNo'
      '           and sf.CalendarNo = :xCalendarNo'
      '           and sn.ForecastTypeNo = 1'
      ''
      '                Into :xsfFORECAST_0'
      '                , :xsfFORECAST_1'
      '                , :xsfFORECAST_2'
      '                , :xsfFORECAST_3'
      '                , :xsfFORECAST_4'
      '                , :xsfFORECAST_5'
      '                , :xsfFORECAST_6'
      '                , :xsfFORECAST_7'
      '                , :xsfFORECAST_8'
      '                , :xsfFORECAST_9'
      '                , :xsfFORECAST_10'
      '                , :xsfFORECAST_11'
      '                , :xsfFORECAST_12'
      '                , :xsfFORECAST_13'
      '                , :xsfFORECAST_14'
      '                , :xsfFORECAST_15'
      '                , :xsfFORECAST_16'
      '                , :xsfFORECAST_17'
      '                , :xsfFORECAST_18'
      '                , :xsfFORECAST_19'
      '                , :xsfFORECAST_20'
      '                , :xsfFORECAST_21'
      '                , :xsfFORECAST_22'
      '                , :xsfFORECAST_23'
      '                , :xsfFORECAST_24'
      '                , :xsfFORECAST_25'
      ''
      ''
      '                , :xsnFORECAST_0'
      '                , :xsnFORECAST_1'
      '                , :xsnFORECAST_2'
      '                , :xsnFORECAST_3'
      '                , :xsnFORECAST_4'
      '                , :xsnFORECAST_5'
      '                , :xsnFORECAST_6'
      '                , :xsnFORECAST_7'
      '                , :xsnFORECAST_8'
      '                , :xsnFORECAST_9'
      '                , :xsnFORECAST_10'
      '                , :xsnFORECAST_11'
      '                , :xsnFORECAST_12'
      '                , :xsnFORECAST_13'
      '                , :xsnFORECAST_14'
      '                , :xsnFORECAST_15'
      '                , :xsnFORECAST_16'
      '                , :xsnFORECAST_17'
      '                , :xsnFORECAST_18'
      '                , :xsnFORECAST_19'
      '                , :xsnFORECAST_20'
      '                , :xsnFORECAST_21'
      '                , :xsnFORECAST_22'
      '                , :xsnFORECAST_23'
      '                , :xsnFORECAST_24'
      '                , :xsnFORECAST_25;'
      ''
      '          IF (OffSet <= 0) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_0 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_0 = xtnFORECAST_0 + xsnFORECAST_0;'
      '            ELSE'
      '                xtnFORECAST_0 = xsnFORECAST_0;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 1) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_1 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_1 = xtnFORECAST_1 + xsnFORECAST_1;'
      '            ELSE'
      '                xtnFORECAST_1 = xsnFORECAST_1;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 2) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_2 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_2 = xtnFORECAST_2 + xsnFORECAST_2;'
      '            ELSE'
      '                xtnFORECAST_2 = xsnFORECAST_2;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 3) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_3 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_3 = xtnFORECAST_3 + xsnFORECAST_3;'
      '            ELSE'
      '                xtnFORECAST_3 = xsnFORECAST_3;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 4) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_4 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_4 = xtnFORECAST_4 + xsnFORECAST_4;'
      '            ELSE'
      '                xtnFORECAST_4 = xsnFORECAST_4;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 5) Then'
      '          BEGIN'
      ''
      '            IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_5 = "Y";'
      ''
      '            IF (AddInd = "A") Then'
      '                xtnFORECAST_5 = xtnFORECAST_5 + xsnFORECAST_5;'
      '            ELSE'
      '                xtnFORECAST_5 = xsnFORECAST_5;'
      ''
      '          END'
      ''
      '          IF (OffSet <= 6) Then'
      '            IF ((Offset+MonthCount) > 6) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                xtfFORECAST_6 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      '                xtnFORECAST_6 = xtnFORECAST_6 + xsnFORECAST_6;'
      '              ELSE'
      '                xtnFORECAST_6 = xsnFORECAST_6;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 7) Then'
      '            IF ((Offset+MonthCount) > 7) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_7 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      '                  xtnFORECAST_7 = xtnFORECAST_7 + xsnFORECAST_7;'
      '              ELSE'
      '                  xtnFORECAST_7 = xsnFORECAST_7;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 8) Then'
      '            IF ((Offset+MonthCount) > 8) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_8 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      '                  xtnFORECAST_8 = xtnFORECAST_8 + xsnFORECAST_8;'
      '              ELSE'
      '                  xtnFORECAST_8 = xsnFORECAST_8;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 9) Then'
      '            IF ((Offset+MonthCount) > 9) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_9 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      '                  xtnFORECAST_9 = xtnFORECAST_9 + xsnFORECAST_9;'
      '              ELSE'
      '                  xtnFORECAST_9 = xsnFORECAST_9;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 10) Then'
      '            IF ((Offset+MonthCount) > 10) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_10 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_10 = xtnFORECAST_10 + xsnFORECAST_' +
        '10;'
      '              ELSE'
      '                  xtnFORECAST_10 = xsnFORECAST_10;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 11) Then'
      '            IF ((Offset+MonthCount) > 11) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_11 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_11 = xtnFORECAST_11 + xsnFORECAST_' +
        '11;'
      '              ELSE'
      '                  xtnFORECAST_11 = xsnFORECAST_11;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 12) Then'
      '            IF ((Offset+MonthCount) > 12) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_12 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_12 = xtnFORECAST_12 + xsnFORECAST_' +
        '12;'
      '              ELSE'
      '                  xtnFORECAST_12 = xsnFORECAST_12;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 13) Then'
      '            IF ((Offset+MonthCount) > 13) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_13 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_13 = xtnFORECAST_13 + xsnFORECAST_' +
        '13;'
      '              ELSE'
      '                  xtnFORECAST_13 = xsnFORECAST_13;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 14) Then'
      '            IF ((Offset+MonthCount) > 14) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_14 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_14 = xtnFORECAST_14 + xsnFORECAST_' +
        '14;'
      '              ELSE'
      '                  xtnFORECAST_14 = xsnFORECAST_14;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 15) Then'
      '            IF ((Offset+MonthCount) > 15) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_15 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_15 = xtnFORECAST_15 + xsnFORECAST_' +
        '15;'
      '              ELSE'
      '                  xtnFORECAST_15 = xsnFORECAST_15;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 16) Then'
      '            IF ((Offset+MonthCount) > 16) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_16 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_16 = xtnFORECAST_16 + xsnFORECAST_' +
        '16;'
      '              ELSE'
      '                  xtnFORECAST_16 = xsnFORECAST_16;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 17) Then'
      '            IF ((Offset+MonthCount) > 17) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_17 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_17 = xtnFORECAST_17 + xsnFORECAST_' +
        '17;'
      '              ELSE'
      '                  xtnFORECAST_17 = xsnFORECAST_17;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 18) Then'
      '            IF ((Offset+MonthCount) > 18) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_18 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_18 = xtnFORECAST_18 + xsnFORECAST_' +
        '18;'
      '              ELSE'
      '                  xtnFORECAST_18 = xsnFORECAST_18;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 19) Then'
      '            IF ((Offset+MonthCount) > 19) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_19 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_19 = xtnFORECAST_19 + xsnFORECAST_' +
        '19;'
      '              ELSE'
      '                  xtnFORECAST_19 = xsnFORECAST_19;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 20) Then'
      '            IF ((Offset+MonthCount) > 20) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_20 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_20 = xtnFORECAST_20 + xsnFORECAST_' +
        '20;'
      '              ELSE'
      '                  xtnFORECAST_20 = xsnFORECAST_20;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 21) Then'
      '            IF ((Offset+MonthCount) > 21) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_21 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_21 = xtnFORECAST_21 + xsnFORECAST_' +
        '21;'
      '              ELSE'
      '                  xtnFORECAST_21 = xsnFORECAST_21;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 22) Then'
      '            IF ((Offset+MonthCount) > 22) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_22 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_22 = xtnFORECAST_22 + xsnFORECAST_' +
        '22;'
      '              ELSE'
      '                  xtnFORECAST_22 = xsnFORECAST_22;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 23) Then'
      '            IF ((Offset+MonthCount) > 23) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_23 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_23 = xtnFORECAST_23 + xsnFORECAST_' +
        '23;'
      '              ELSE'
      '                  xtnFORECAST_23 = xsnFORECAST_23;'
      ''
      '            END'
      ''
      '          IF (OffSet <= 24) Then'
      '            IF ((Offset+MonthCount) > 24) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_24 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_24 = xtnFORECAST_24 + xsnFORECAST_' +
        '24;'
      '              ELSE'
      '                  xtnFORECAST_24 = xsnFORECAST_24;'
      ''
      '            END'
      ''
      '          /* Support 24 months and over */'
      '          IF (OffSet <= 24) Then'
      '            IF ((Offset+MonthCount) > 24) Then'
      '            BEGIN'
      ''
      '              IF (FreezeInd = "Y") Then'
      '                  xtfFORECAST_25 = "Y";'
      ''
      '              IF (AddInd = "A") Then'
      
        '                  xtnFORECAST_25 = xtnFORECAST_25 + xsnFORECAST_' +
        '25;'
      '              ELSE'
      '                  xtnFORECAST_25 = xsnFORECAST_25;'
      ''
      '            END'
      ''
      ''
      '          Update ItemFrozenForecast'
      '          Set FORECAST_0      = :xtfFORECAST_0'
      '                , FORECAST_1      = :xtfFORECAST_1'
      '                , FORECAST_2      = :xtfFORECAST_2'
      '                , FORECAST_3      = :xtfFORECAST_3'
      '                , FORECAST_4      = :xtfFORECAST_4'
      '                , FORECAST_5      = :xtfFORECAST_5'
      '                , FORECAST_6      = :xtfFORECAST_6'
      '                , FORECAST_7      = :xtfFORECAST_7'
      '                , FORECAST_8      = :xtfFORECAST_8'
      '                , FORECAST_9      = :xtfFORECAST_9'
      '                , FORECAST_10     = :xtfFORECAST_10'
      '                , FORECAST_11     = :xtfFORECAST_11'
      '                , FORECAST_12     = :xtfFORECAST_12'
      '                , FORECAST_13     = :xtfFORECAST_13'
      '                , FORECAST_14     = :xtfFORECAST_14'
      '                , FORECAST_15     = :xtfFORECAST_15'
      '                , FORECAST_16     = :xtfFORECAST_16'
      '                , FORECAST_17     = :xtfFORECAST_17'
      '                , FORECAST_18     = :xtfFORECAST_18'
      '                , FORECAST_19     = :xtfFORECAST_19'
      '                , FORECAST_20     = :xtfFORECAST_20'
      '                , FORECAST_21     = :xtfFORECAST_21'
      '                , FORECAST_22     = :xtfFORECAST_22'
      '                , FORECAST_23     = :xtfFORECAST_23'
      '                , FORECAST_24     = :xtfFORECAST_24'
      '                , FORECAST_25     = :xtfFORECAST_25'
      ''
      '                where ItemNo = :xTargetItem'
      '                        and CalendarNo = :xCalendarNo;'
      ''
      '          Update ItemForecast'
      '          Set FORECAST_0      = :xtnFORECAST_0'
      '                , FORECAST_1      = :xtnFORECAST_1'
      '                , FORECAST_2      = :xtnFORECAST_2'
      '                , FORECAST_3      = :xtnFORECAST_3'
      '                , FORECAST_4      = :xtnFORECAST_4'
      '                , FORECAST_5      = :xtnFORECAST_5'
      '                , FORECAST_6      = :xtnFORECAST_6'
      '                , FORECAST_7      = :xtnFORECAST_7'
      '                , FORECAST_8      = :xtnFORECAST_8'
      '                , FORECAST_9      = :xtnFORECAST_9'
      '                , FORECAST_10     = :xtnFORECAST_10'
      '                , FORECAST_11     = :xtnFORECAST_11'
      '                , FORECAST_12     = :xtnFORECAST_12'
      '                , FORECAST_13     = :xtnFORECAST_13'
      '                , FORECAST_14     = :xtnFORECAST_14'
      '                , FORECAST_15     = :xtnFORECAST_15'
      '                , FORECAST_16     = :xtnFORECAST_16'
      '                , FORECAST_17     = :xtnFORECAST_17'
      '                , FORECAST_18     = :xtnFORECAST_18'
      '                , FORECAST_19     = :xtnFORECAST_19'
      '                , FORECAST_20     = :xtnFORECAST_20'
      '                , FORECAST_21     = :xtnFORECAST_21'
      '                , FORECAST_22     = :xtnFORECAST_22'
      '                , FORECAST_23     = :xtnFORECAST_23'
      '                , FORECAST_24     = :xtnFORECAST_24'
      '                , FORECAST_25     = :xtnFORECAST_25'
      ''
      '                where ItemNo = :xTargetItem'
      '                        and CalendarNo = :xCalendarNo'
      '                        and ForecastTypeNo = 1;'
      ''
      ''
      ''
      ''
      'end')
    Transaction = trnOptimiza
    Left = 136
    Top = 296
  end
end
